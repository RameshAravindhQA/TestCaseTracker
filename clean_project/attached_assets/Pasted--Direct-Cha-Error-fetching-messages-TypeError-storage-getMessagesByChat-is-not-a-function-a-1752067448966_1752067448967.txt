"Direct Cha…
Error fetching messages: TypeError: storage.getMessagesByChat is not a function
    at <anonymous> (/home/runner/workspace/server/routes.ts:8192:38)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at next (/home/runner/workspace/node_modules/express/lib/router/route.js:149:13)
    at isAuthenticated (/home/runner/workspace/server/routes.ts:75:12)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at next (/home/runner/workspace/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/home/runner/workspace/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at /home/runner/workspace/node_modules/express/lib/router/index.js:284:15
    at param (/home/runner/workspace/node_modules/express/lib/router/index.js:365:14)
    at param (/home/runner/workspace/node_modules/express/lib/router/index.js:376:14)
    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:421:3)
    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)
    at Function.handle (/home/runner/workspace/node_modules/express/lib/router/index.js:175:3)
    at router (/home/runner/workspace/node_modules/express/lib/router/index.js:47:12)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/runner/workspace/node_modules/express/lib/router/index.js:328:13)
    at /home/runner/workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)
    at Immediate._onImmediate (/home/runner/workspace/node_modules/express-session/index.js:514:7)
    at process.processImmediate (node:internal/timers:485:21)
1:23:23 PM [express] GET /api/chats/1752067402262/messages 500 in 22ms :: {"error":"Failed to fetch …
Error fetching messages: TypeError: storage.getMessagesByChat is not a function
    at <anonymous> (/home/runner/workspace/server/routes.ts:8192:38)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at next (/home/runner/workspace/node_modules/express/lib/router/route.js:149:13)
    at isAuthenticated (/home/runner/workspace/server/routes.ts:75:12)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at next (/home/runner/workspace/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/home/runner/workspace/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at /home/runner/workspace/node_modules/express/lib/router/index.js:284:15
    at param (/home/runner/workspace/node_modules/express/lib/router/index.js:365:14)
    at param (/home/runner/workspace/node_modules/express/lib/router/index.js:376:14)
    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:421:3)
    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)
    at Function.handle (/home/runner/workspace/node_modules/express/lib/router/index.js:175:3)
    at router (/home/runner/workspace/node_modules/express/lib/router/index.js:47:12)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/runner/workspace/node_modules/express/lib/router/index.js:328:13)
    at /home/runner/workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)
    at Immediate._onImmediate (/home/runner/workspace/node_modules/express-session/index.js:514:7)
    at process.processImmediate (node:internal/timers:485:21)
1:23:23 PM [express] GET /api/chats/1/messages 500 in 2ms :: {"error":"Failed to fetch messages"}
Error fetching messages: TypeError: storage.getMessagesByChat is not a function
    at <anonymous> (/home/runner/workspace/server/routes.ts:8192:38)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at next (/home/runner/workspace/node_modules/express/lib/router/route.js:149:13)
    at isAuthenticated (/home/runner/workspace/server/routes.ts:75:12)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at next (/home/runner/workspace/node_modules/express/lib/router/route.js:149:13)
    at Route.dispatch (/home/runner/workspace/node_modules/express/lib/router/route.js:119:3)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at /home/runner/workspace/node_modules/express/lib/router/index.js:284:15
    at param (/home/runner/workspace/node_modules/express/lib/router/index.js:365:14)
    at param (/home/runner/workspace/node_modules/express/lib/router/index.js:376:14)
    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:421:3)
    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)
    at Function.handle (/home/runner/workspace/node_modules/express/lib/router/index.js:175:3)
    at router (/home/runner/workspace/node_modules/express/lib/router/index.js:47:12)
    at Layer.handle [as handle_request] (/home/runner/workspace/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/home/runner/workspace/node_modules/express/lib/router/index.js:328:13)
    at /home/runner/workspace/node_modules/express/lib/router/index.js:286:9
    at Function.process_params (/home/runner/workspace/node_modules/express/lib/router/index.js:346:12)
    at next (/home/runner/workspace/node_modules/express/lib/router/index.js:280:10)
    at Immediate._onImmediate (/home/runner/workspace/node_modules/express-session/index.js:514:7)
    at process.processImmediate (node:internal/timers:485:21)
1:23:23 PM [express] GET /api/chats/1/messages 500 in 2ms :: {"error":"Failed to fetch messages"}
[2025-07-09T13:23:29.686Z] ERROR: Error sending message: TypeError: this.chatMessages.push is not a function
    at MemStorage.createChatMessage (/home/runner/workspace/server/storage.ts:2053:23)
    at ChatService.createChatMessage (/home/runner/workspace/server/chat-service.ts:118:19)
    at WebSocket.<anonymous> (/home/runner/workspace/server/websocket-setup.ts:63:55)
    at WebSocket.emit (node:events:518:28)
    at Receiver.receiverOnMessage (/home/runner/workspace/node_modules/ws/lib/websocket.js:1220:20)
    at Receiver.emit (node:events:518:28)
    at Receiver.dataMessage (/home/runner/workspace/node_modules/ws/lib/receiver.js:596:14)
    at Receiver.getData (/home/runner/workspace/node_modules/ws/lib/receiver.js:496:10)
    at Receiver.startLoop (/home/runner/workspace/node_modules/ws/lib/receiver.js:167:16)
    at Receiver._write (/home/runner/workspace/node_modules/ws/lib/receiver.js:94:10)
    at writeOrBuffer (node:internal/streams/writable:572:12)
    at _write (node:internal/streams/writable:501:10)
    at Writable.write (node:internal/streams/writable:510:10)
    at Socket.socketOnData (/home/runner/workspace/node_modules/ws/lib/websocket.js:1355:35)
    at Socket.emit (node:events:518:28)
    at addChunk (node:internal/streams/readable:561:12)
    at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
    at Readable.push (node:internal/streams/readable:392:5)
    at TCP.onStreamRead (node:internal/stream_base_commons:191:23)
^C